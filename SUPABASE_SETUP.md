# Web Store - Supabase Integration Guide

## ‚úÖ –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### 1. Frontend –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ Supabase
- `src/lib/supabaseClient.ts` –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –≤–∞—à–∏–º–∏ credentials
- URL: `https://fszhfeqijasvplmdihyj.supabase.co`
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç Supabase –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### 2. Database Schema –≥–æ—Ç–æ–≤–∞
- –§–∞–π–ª: `supabase/schema.sql` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã:
  - `users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
  - `apps` - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - `translations` - –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å
  - `favorites` - –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
  - `likes` - –ª–∞–π–∫–∏
  - `comments` - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
  - `dev_accounts` - –∞–∫–∫–∞—É–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
  - `analytics` - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–ø—Ä–æ—Å–º–æ—Ç—Ä—ã, —É—Å—Ç–∞–Ω–æ–≤–∫–∏)

### 3. Helper Functions
- –§–∞–π–ª: `supabase/functions.sql` —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - `increment_views(app_id)` - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
  - `increment_installs(app_id)` - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–æ–∫

### 4. Analytics –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞
- `src/hooks/useAnalytics.ts` - —Ö—É–∫ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç:
  - **–ü—Ä–æ—Å–º–æ—Ç—Ä—ã** - –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ AppDetails
  - **–£—Å—Ç–∞–Ω–æ–≤–∫–∏** - –ø—Ä–∏ –∫–ª–∏–∫–µ "–°–∫–∞—á–∞—Ç—å" –≤ –ª—é–±–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ

### 5. Developer Dashboard
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ Supabase
- –ú–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (—É—Å—Ç–∞–Ω–æ–≤–∫–∏, —Ä–µ–π—Ç–∏–Ω–≥)

## üöÄ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ Supabase Dashboard

### –®–∞–≥ 1: –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL –º–∏–≥—Ä–∞—Ü–∏–∏

–ó–∞–π–¥–∏—Ç–µ –≤ Supabase Dashboard ‚Üí SQL Editor –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

1. **–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã**:
```sql
-- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ supabase/schema.sql
```

2. **–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏**:
```sql
-- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ supabase/functions.sql
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å RLS (Row Level Security)

–î–æ–±–∞–≤—å—Ç–µ –±–∞–∑–æ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```sql
-- –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ–º —á–∏—Ç–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
CREATE POLICY "Allow public read access to apps"
ON public.apps FOR SELECT
USING (true);

-- –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ–º —á–∏—Ç–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE POLICY "Allow public read access to users"
ON public.users FOR SELECT
USING (true);

-- –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É
CREATE POLICY "Allow public insert to analytics"
ON public.analytics FOR INSERT
WITH CHECK (true);
```

### –®–∞–≥ 3: –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```sql
-- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
INSERT INTO public.users (email, display_name, avatar)
VALUES ('test@example.com', 'Test Developer', 'https://api.dicebear.com/7.x/avataaars/svg?seed=test');

-- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
INSERT INTO public.apps (
  slug,
  developer_id,
  icon_url,
  screenshots,
  categories,
  rating,
  install_url,
  manifest_url,
  verified,
  views,
  installs
)
VALUES (
  'crypto-wallet-pro',
  (SELECT id FROM public.users LIMIT 1),
  'https://images.unsplash.com/photo-1621761191319-c6fb62004040?w=200&h=200&fit=crop',
  ARRAY['https://images.unsplash.com/photo-1621761191319-c6fb62004040?w=1920&h=1080&fit=crop'],
  ARRAY['Crypto', 'Finance'],
  4.8,
  'https://example.com/install',
  'https://example.com/manifest.json',
  true,
  15420,
  8500
);
```

## üìä –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

1. **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞** (`/`)
   - –î–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ Supabase
   - –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç mock –¥–∞–Ω–Ω—ã–µ
   - Debug –ø–∞–Ω–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

2. **–ö–∞–±–∏–Ω–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞** (`/developer`)
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ Supabase
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

3. **–î–µ—Ç–∞–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** (`/app/:id`)
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase
   - –õ–æ–≥–∏—Ä—É–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä –≤ analytics
   - –ü—Ä–∏ –∫–ª–∏–∫–µ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å" - –ª–æ–≥–∏—Ä—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É
## üìù TODO (–±—É–¥—É—â–µ–µ)

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (auth.uid())
- [ ] –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ developer_id –≤ Dashboard
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∫–æ–Ω–æ–∫ –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –≤ Storage
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É translations
- [ ] –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ –ª–∞–π–∫–æ–≤
- [ ] –ó–∞—è–≤–∫–∏ –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
src/
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ supabaseClient.ts      # Supabase –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useAnalytics.ts        # –•—É–∫ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îú‚îÄ‚îÄ Index.tsx              # –ì–ª–∞–≤–Ω–∞—è (–∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ Supabase)
‚îÇ   ‚îú‚îÄ‚îÄ DeveloperDashboard.tsx # –ö–∞–±–∏–Ω–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ AppDetails.tsx         # –î–µ—Ç–∞–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ components/
    ‚îú‚îÄ‚îÄ AppCard.tsx            # –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ AppListItem.tsx        # –≠–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞
    ‚îî‚îÄ‚îÄ FeaturedCard.tsx       # –ë–æ–ª—å—à–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞

supabase/
‚îú‚îÄ‚îÄ schema.sql                 # Database schema
‚îî‚îÄ‚îÄ functions.sql              # Helper functions
```

### PWA Manifest
- –í—Å–µ –∏–∫–æ–Ω–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (192x192, 512x512)
- manifest.json –æ–±–Ω–æ–≤–ª–µ–Ω
- Lighthouse PWA audit –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ –±–µ–∑ –æ—à–∏–±–æ–∫
